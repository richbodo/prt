[pytest]
# Pytest configuration for PRT

# Test markers for organizing test types
markers =
    unit: Fast unit tests (< 1 second) - test deterministic components without external dependencies
    integration: Integration tests with mocks (< 5 seconds) - test workflows with MockLLMService
    contract: LLM contract tests with promptfoo (1-5 minutes) - validate real LLM behavior
    slow: Slow end-to-end tests (5-10 minutes) - manual/nightly full system tests
    requires_llm: Tests that require real LLM connection (Ollama running)
    requires_db: Tests that require database connection

# Test discovery patterns
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Directories to ignore during test collection
norecursedirs = .git .tox dist build *.egg prt_env EXTERNAL_DOCS docs

# Output options
addopts =
    --strict-markers
    --verbose
    --tb=short
    -ra

# Asyncio mode for async tests
asyncio_mode = auto

# Coverage options (when using --cov flag)
[coverage:run]
source = prt_src
omit =
    */tests/*
    */conftest.py
    */__pycache__/*

[coverage:report]
precision = 2
show_missing = True
skip_covered = False

# Exclude lines from coverage
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    if TYPE_CHECKING:
    @abstractmethod
